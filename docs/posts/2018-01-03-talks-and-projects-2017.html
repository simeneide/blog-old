<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2018-01-03">

<title>eide.ai - Deep Recommenders, Car Pricing, Self driving rc-car and other projects in 2017</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">eide.ai</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/simeneide" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/simeneide" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Deep Recommenders, Car Pricing, Self driving rc-car and other projects in 2017</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">recsys</div>
                <div class="quarto-category">carprice</div>
                <div class="quarto-category">autonomous cars</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 3, 2018</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-to-become-a-data-scientist-in-20-minutes-javazone-2017" id="toc-how-to-become-a-data-scientist-in-20-minutes-javazone-2017" class="nav-link active" data-scroll-target="#how-to-become-a-data-scientist-in-20-minutes-javazone-2017">How to become a Data Scientist in 20 minutes (JavaZone 2017)</a></li>
  <li><a href="#algorithms-we-are-using-in-finn.no-to-recommend-you-good-stuff" id="toc-algorithms-we-are-using-in-finn.no-to-recommend-you-good-stuff" class="nav-link" data-scroll-target="#algorithms-we-are-using-in-finn.no-to-recommend-you-good-stuff">Algorithms we are using in FINN.no to recommend you good stuff</a></li>
  <li><a href="#workshop-for-finn-developers-on-machine-learning" id="toc-workshop-for-finn-developers-on-machine-learning" class="nav-link" data-scroll-target="#workshop-for-finn-developers-on-machine-learning">Workshop for FINN developers on Machine Learning</a></li>
  <li><a href="#clothing-gans" id="toc-clothing-gans" class="nav-link" data-scroll-target="#clothing-gans">Clothing GANs</a></li>
  <li><a href="#neural-search-engines" id="toc-neural-search-engines" class="nav-link" data-scroll-target="#neural-search-engines">Neural Search Engines</a></li>
  <li><a href="#self-driving-rc-car" id="toc-self-driving-rc-car" class="nav-link" data-scroll-target="#self-driving-rc-car">Self driving rc-car ++</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>I am not a fan of new years resolutions. If I had been, one of my new years resolutions would be to be better at writing down what I am doing all the time. However, I held some talks and did some fun experiments in 2017, so the cheap way is simply to link to those.</p>
<section id="how-to-become-a-data-scientist-in-20-minutes-javazone-2017" class="level3">
<h3 class="anchored" data-anchor-id="how-to-become-a-data-scientist-in-20-minutes-javazone-2017">How to become a Data Scientist in 20 minutes (JavaZone 2017)</h3>
<p>At Javazone 2017 I held a short talk on how building (drum roll) <em>machine learning algorithms</em> is actually pretty easy. Simply put: I build a regression model that would predict the fair price of a car, and then I explained how I used that model to actually buy the car. The main message was that as long as you do your model validation properly (dont train and test on same data), you dont really need to understand the algorithm to get good results (use random forest!).</p>
<p>We <a href="https://github.com/simeneide/car-pricing"><strong>published both algorithm and the dataset here</strong></a> so that anyone could replicate it, and JavaZone even filmed it:</p>
<iframe src="https://player.vimeo.com/video/233848280" width="640" height="360" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="">
</iframe>
</section>
<section id="algorithms-we-are-using-in-finn.no-to-recommend-you-good-stuff" class="level3">
<h3 class="anchored" data-anchor-id="algorithms-we-are-using-in-finn.no-to-recommend-you-good-stuff">Algorithms we are using in FINN.no to recommend you good stuff</h3>
<p><img src="assets_old/assets/2017-10-10-eide-finn-model-zoo.png" alt="How FINNs personalization algorithms work" style="float:right;width: 40%;"></p>
<p>I have actually held three talks on this. First off was the one <a href="https://simeneide.github.io/recommendations/2017/03/16/osloDataSciencePresentation.html">I held at Oslo Data Science meetup</a> in February, where I talked about the journey we did from pure CF-models to using Tensorflow.</p>
<p>After that we have tried out a lot of things, and also moved to use keras instead, so we could skip all the boilerplate. Ive held two talks this fall on it: one beer-talk hosted by Bekk Consulting, and one early-morning talk with Bearpoint. The presentations were very similar, and can be <a href="../assets/2017-10-10-eide-finn-personalization-BekkBearingpoint.pdf"><strong>downloaded here</strong></a>.</p>
<blockquote class="twitter-tweet blockquote" data-lang="en">
<p lang="en" dir="ltr">
Testing RNN <a href="https://twitter.com/hashtag/recommenders?src=hash&amp;ref_src=twsrc%5Etfw">#recommenders</a> for <a href="https://twitter.com/FINN_tech?ref_src=twsrc%5Etfw"><span class="citation" data-cites="FINN_tech">@FINN_tech</span></a>. The RNN (bottom) generalize better when looking at last 10 items compared to only the last (mid). <a href="https://t.co/feZMcz1n97">pic.twitter.com/feZMcz1n97</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/903272337960824834?ref_src=twsrc%5Etfw">August 31, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section>
<section id="workshop-for-finn-developers-on-machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="workshop-for-finn-developers-on-machine-learning">Workshop for FINN developers on Machine Learning</h3>
<p>In November I held a 3 hour workshop with some colleages on machine learning. The idea was, just as in the javazone talk, to demystify building these models. We spun up GPU machines to all the participants, prepared a dataset many FINN ads and a baseline script on how they could classify the ads based on their title. It was around 500’000 ads spread over 20 or so categories. The task was then to understand the baseline algorithm, then improve it by changing architechture, learning rates, optimizers and so on. The baseline started by taking averages of the word2vec vectors of the title, but the winners used a GRU-layer on the title to snitch the last percentage points on the validation accuracy. That was really impressive, none of them had done machine learning before, and then they start tinkering with recurrent neural nets!</p>
<blockquote class="twitter-tweet blockquote" data-lang="en">
<p lang="en" dir="ltr">
Data scientist beware! Sixty developers at <a href="https://twitter.com/FINN_tech?ref_src=twsrc%5Etfw"><span class="citation" data-cites="FINN_tech">@FINN_tech</span></a> with no prior <a href="https://twitter.com/hashtag/MachineLearning?src=hash&amp;ref_src=twsrc%5Etfw">#MachineLearning</a> experience just build a deep neural classifier in 2.5hrs that beat my model! <a href="https://t.co/HmG29pi7mM">pic.twitter.com/HmG29pi7mM</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/933011881371099136?ref_src=twsrc%5Etfw">November 21, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section>
<section id="clothing-gans" class="level3">
<h3 class="anchored" data-anchor-id="clothing-gans">Clothing GANs</h3>
<p>We had a little GAN-workshop at the end of the year here, where we among other things trained a model to generate new clothing. I was impressed how easy that was. Maybe FINN should start generating images of your ad if you cant be bothered to take your own photos? ;)</p>
<blockquote class="twitter-tweet blockquote" data-lang="en">
<p lang="en" dir="ltr">
Do you need to sell off some clothes at <a href="https://twitter.com/FINN_tech?ref_src=twsrc%5Etfw"><span class="citation" data-cites="FINN_tech">@FINN_tech</span></a>, but not happy with your own image? This is our first try at building a <a href="https://twitter.com/hashtag/GAN?src=hash&amp;ref_src=twsrc%5Etfw">#GAN</a> model that can generate arbitrary clothing images for you! Next steps: upscaling, conditioning and maybe a fashion show? <a href="https://t.co/Vkd7takdHT">pic.twitter.com/Vkd7takdHT</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/942370686257041410?ref_src=twsrc%5Etfw">December 17, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section>
<section id="neural-search-engines" class="level3">
<h3 class="anchored" data-anchor-id="neural-search-engines">Neural Search Engines</h3>
<p>Ive tried to work on models that take text input and outputs a finn ad (aka search engine). They were also enhanced with user-features, so that the search would be personalized to the exact user. It worked all right, but we are currently working on a “simpler” way to personalize FINNs search results, combining the good old search engine with our recommendation models.</p>
<blockquote class="twitter-tweet blockquote" data-lang="en">
<p lang="en" dir="ltr">
Search engines are maybe not the most sexy, but it was really fun to learn a model to predict our <a href="https://twitter.com/hashtag/recommendation?src=hash&amp;ref_src=twsrc%5Etfw">#recommendation</a> vectors based on a word! <a href="https://t.co/yPDsLkKYxc">pic.twitter.com/yPDsLkKYxc</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/905085732397735937?ref_src=twsrc%5Etfw">September 5, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section>
<section id="self-driving-rc-car" class="level3">
<h3 class="anchored" data-anchor-id="self-driving-rc-car">Self driving rc-car ++</h3>
<p>Ive been tinkering a bit with a self driving car. The project is called <a href="http://www.donkeycar.com">donkeycar</a>. Basically it is a rc-car that you can run through a python API with a raspberry pi. They have also integrated tensorflow, so that you can use imitation learning to drive a path. I got it to follow the road, and also a white line. Hopes was to spend enough time to build some reinforcement learning into it, but I haven’t had time (yet!).</p>
<blockquote class="twitter-tweet blockquote" data-lang="en" style="float:left;width:100%">
<p lang="no" dir="ltr">
Bil + nevralt nett = SELVKJØRENDE BIL! Kan jeg claime Norges første selvkjørende amatørbil?! <a href="https://twitter.com/hashtag/autonomousdriving?src=hash&amp;ref_src=twsrc%5Etfw">#autonomousdriving</a> <a href="https://twitter.com/hashtag/donkeycar?src=hash&amp;ref_src=twsrc%5Etfw">#donkeycar</a> <a href="https://twitter.com/hashtag/in?src=hash&amp;ref_src=twsrc%5Etfw">#in</a> <a href="https://twitter.com/hashtag/DeepLearning?src=hash&amp;ref_src=twsrc%5Etfw">#DeepLearning</a> <a href="https://t.co/vwZJcfLqLd">pic.twitter.com/vwZJcfLqLd</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/898611037385117696?ref_src=twsrc%5Etfw">August 18, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<blockquote class="twitter-tweet blockquote" data-lang="en" style="float:right;width:100%">
<p lang="en" dir="ltr">
Our self driving project isnt fast, but atleast can go on forever. Driving using a single neural network on a raspberry PI <a href="https://twitter.com/hashtag/donkeycar?src=hash&amp;ref_src=twsrc%5Etfw">#donkeycar</a> <a href="https://t.co/6y5sf8AnMi">pic.twitter.com/6y5sf8AnMi</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/924223645592977408?ref_src=twsrc%5Etfw">October 28, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<blockquote class="twitter-tweet blockquote" data-lang="en">
<p lang="en" dir="ltr">
How my <a href="https://twitter.com/hashtag/donkeycar?src=hash&amp;ref_src=twsrc%5Etfw">#donkeycar</a> is detecting road, grass and horizon for <a href="https://twitter.com/hashtag/autonomousdriving?src=hash&amp;ref_src=twsrc%5Etfw">#autonomousdriving</a>. Slow and steady progress.. <a href="https://t.co/VlL3hGmcWn">pic.twitter.com/VlL3hGmcWn</a>
</p>
— Simen Eide (<span class="citation" data-cites="simeneide">@simeneide</span>) <a href="https://twitter.com/simeneide/status/903765232199356420?ref_src=twsrc%5Etfw">September 1, 2017</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>